<%-include("partials/header.ejs",{title:"Home",user:user})%>

<!-- Hero Section -->
<div class="hero-gradient text-white py-5 mb-5">
  <div class="container text-center">
    <h1 class="display-4 fw-bold mb-3"><i class="fas fa-blog me-3"></i>Welcome to CTK Blog</h1>
    <p class="lead mb-4">Share your thoughts, read amazing posts, and connect with the community.</p>
    <% if(!user){ %>
      <a href="/register" class="btn btn-light btn-lg me-3"><i class="fas fa-user-plus me-2"></i>Get Started</a>
      <a href="/login" class="btn btn-outline-light btn-lg"><i class="fas fa-sign-in-alt me-2"></i>Login</a>
    <% } else { %>
      <a href="/posts/add" class="btn btn-light btn-lg"><i class="fas fa-plus me-2"></i>Create Post</a>
    <% } %>
  </div>
</div>

<!-- Stats Cards -->
<!-- Stats Cards -->
<div class="row mb-5">
  <div class="col-md-4 mb-4">
    <div class="card shadow h-100 text-center border-0 bg-gradient-primary text-white">
      <div class="card-body py-4">
        <i class="fas fa-file-alt fa-3x mb-3 opacity-75"></i>
        <h3 class="fw-bold"><%= stats.posts %></h3>
        <p class="mb-0">Total Posts</p>
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card shadow h-100 text-center border-0 bg-gradient-success text-white">
      <div class="card-body py-4">
        <i class="fas fa-users fa-3x mb-3 opacity-75"></i>
        <h3 class="fw-bold"><%= stats.users %></h3>
        <p class="mb-0">Registered Users</p>
      </div>
    </div>
  </div>
  <div class="col-md-4 mb-4">
    <div class="card shadow h-100 text-center border-0 bg-gradient-info text-white">
      <div class="card-body py-4">
        <i class="fas fa-eye fa-3x mb-3 opacity-75"></i>
        <h3 class="fw-bold"><%= stats.views %></h3>
        <p class="mb-0">Total Views</p>
      </div>
    </div>
  </div>
</div>

<!-- Recent Posts -->
<!-- Recent Posts -->
<h2 class="mb-4"><i class="fas fa-list text-primary me-2"></i>Recent Posts</h2>
<div class="row g-4 mb-5">
  <% if(posts.length > 0) { %>
    <% posts.forEach(post => { %>
      <div class="col-md-6 col-lg-4">
        <div class="card shadow h-100 border-0 hover-shadow">
          <!-- Optional Image Placeholder -->
          <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
            <% if(post.images && post.images.length > 0) { %>
               <img src="<%= post.images[0].url %>" alt="Post Image" style="width:100%; height:100%; object-fit:cover;">
            <% } else { %>
               <i class="fas fa-image fa-4x text-muted"></i>
            <% } %>
          </div>
          <div class="card-body">
            <span class="badge bg-primary mb-2"><%= post.category %></span>
            <h5 class="card-title"><%= post.title %></h5>
            <p class="card-text"><%= post.content.substring(0, 100) %>...</p>
            <div class="d-flex justify-content-between align-items-center">
              <small class="text-muted"><%= post.author ? post.author.username : 'Unknown' %> â€¢ <%= new Date(post.createdAt).toLocaleDateString() %></small>
              <a href="/posts/<%= post._id %>" class="btn btn-outline-primary btn-sm">Read More</a>
            </div>
          </div>
        </div>
      </div>
    <% }) %>
  <% } else { %>
    <p class="text-center text-muted">No posts found yet.</p>
  <% } %>
</div>

<!-- User Section -->
<% if(user){ %>
<div class="row">
  <div class="col-lg-8">
    <h3><i class="fas fa-user-circle text-primary me-2"></i>Welcome back, <%= user.username %>!</h3>
    <p class="lead">Your recent activity and quick actions.</p>
    <div class="row g-3">
      <div class="col-md-6">
        <a href="/posts/add" class="btn btn-outline-primary w-100 py-3"><i class="fas fa-edit me-2"></i>Create New Post</a>
      </div>
      <div class="col-md-6">
        <a href="/posts" class="btn btn-outline-success w-100 py-3"><i class="fas fa-list me-2"></i>My Posts</a>
      </div>
    </div>
  </div>
  <!-- <div class="col-lg-4">
    <div class="card shadow">
      <div class="card-header bg-primary text-white">
        <h6 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Quick Stats</h6>
      </div>
      <div class="card-body">
        <div class="d-flex justify-content-between mb-2">
          <span>Posts:</span> <strong>3</strong>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span>Views:</span> <strong>245</strong>
        </div>
        <div class="d-flex justify-content-between">
          <span>Likes:</span> <strong>12</strong>
        </div>
      </div>
    </div>
  </div> -->


  

</div>
<% } %>

<%-include("partials/footer.ejs")%>
